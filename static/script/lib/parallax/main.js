if("undefined"==typeof Zepto)throw new Error("Parallax.js's script requires Zepto");!function(a){"use strict";function r(){x.loading?a(".wrapper").append('<div class="parallax-loading"><i class="ui-loading ui-loading-white"></i></div>'):y=!1,u=0,h="stay",g=k.length,m=a(window).width(),b=a(window).height(),C=a("[data-animation]");for(var r=0;g>r;r++)a(k[r]).attr("data-id",r+1);v.addClass(x.direction).addClass(x.swipeAnim),k.css({width:m+"px",height:b+"px"}),"horizontal"===x.direction?v.css("width",m*k.length):v.css("height",b*k.length),"cover"===x.swipeAnim&&(v.css({width:m,height:b}),k[0].style.display="block"),x.loading||(a(k[u]).addClass("current"),x.onchange(u,k[u],h),l())}function t(a){return y===!0?(event.preventDefault(),!1):(z=!0,c="horizontal"===x.direction?a.pageX:a.pageY,"default"===x.swipeAnim&&(v.addClass("drag"),p=v.css("-webkit-transform").replace("matrix(","").replace(")","").split(","),p="horizontal"===x.direction?parseInt(p[4]):parseInt(p[5])),"cover"===x.swipeAnim&&x.drag&&k.addClass("drag"),void(f=1))}function i(a){return y===!0||z===!1?(event.preventDefault(),!1):(event.preventDefault(),w="horizontal"===x.direction?a.pageX:a.pageY,s(),x.drag&&!d()&&e(),void(f=2))}function n(r){y===!0||2!==f||(z=!1,w="horizontal"===x.direction?r.pageX:r.pageY,"default"!==x.swipeAnim||d()?"cover"!==x.swipeAnim||d()||(Math.abs(w-c)<=50&&w>=c&&x.drag?(o(u,"keep-backward"),h="stay"):Math.abs(w-c)<=50&&c>w&&x.drag?(o(u,"keep-forward"),h="stay"):Math.abs(w-c)>50&&w>=c&&x.drag?(o(u-1,"backward"),h="backward"):Math.abs(w-c)>50&&c>w&&x.drag?(o(u+1,"forward"),h="forward"):Math.abs(w-c)>50&&w>=c&&!x.drag?(o(u-1,"backward"),h="backward"):Math.abs(w-c)>50&&c>w&&!x.drag&&(o(u+1,"forward"),h="forward")):(v.removeClass("drag"),Math.abs(w-c)<=50?(o(u),h="stay"):w>=c?(o(u-1),h="backward"):c>w&&(o(u+1),h="forward")),x.indicator&&a(a(".parallax-h-indicator ul li, .parallax-v-indicator ul li").removeClass("current").get(u)).addClass("current"),f=3)}function e(){if("default"===x.swipeAnim){var r=p+w-c;"horizontal"===x.direction?v.css("-webkit-transform","matrix(1, 0, 0, 1, "+r+", 0)"):v.css("-webkit-transform","matrix(1, 0, 0, 1, 0, "+r+")")}else if("cover"===x.swipeAnim){var r=w-c,t=a(k[u-1]),i=a(k[u+1]);a(k).css({"z-index":0}),"horizontal"===x.direction&&w>=c?t.css({"z-index":2,display:"block","-webkit-transform":"translateX("+(r-m)+"px)"}):"horizontal"===x.direction&&c>w?i.css({"z-index":2,display:"block","-webkit-transform":"translateX("+(m+r)+"px)"}):"vertical"===x.direction&&w>=c?t.css({"z-index":2,display:"block","-webkit-transform":"translateY("+(r-b)+"px)"}):"vertical"===x.direction&&c>w&&i.css({"z-index":2,display:"block","-webkit-transform":"translateY("+(b+r)+"px)"})}}function o(r,t){if(u=r,"default"===x.swipeAnim){var i=0;i="horizontal"===x.direction?r*-m:r*-b,"horizontal"===x.direction?v.css({"-webkit-transform":"matrix(1, 0, 0, 1, "+i+", 0)"}):v.css({"-webkit-transform":"matrix(1, 0, 0, 1, 0, "+i+")"})}else"cover"===x.swipeAnim&&("keep-backward"===t&&x.drag?(k.removeClass("drag"),"horizontal"===x.direction?a(k[u-1]).css({"-webkit-transform":"translateX(-100%)"}):a(k[u-1]).css({"-webkit-transform":"translateY(-100%)"})):"keep-forward"===t&&x.drag?(k.removeClass("drag"),"horizontal"===x.direction?a(k[u+1]).css({"-webkit-transform":"translateX(100%)"}):a(k[u+1]).css({"-webkit-transform":"translateY(100%)"})):"forward"===t&&x.drag?(k.removeClass("drag"),a(k[u-1]).addClass("back"),k[u].style.webkitTransform="translate(0, 0)"):"backward"===t&&x.drag?(k.removeClass("drag"),a(k[u+1]).addClass("back"),k[u].style.webkitTransform="translate(0, 0)"):"forward"!==t||x.drag?"backward"!==t||x.drag||(v.addClass("animate"),a(k[u+1]).addClass("back"),a(k[u]).addClass("front").show()):(v.addClass("animate"),a(k[u-1]).addClass("back"),a(k[u]).addClass("front").show()));y=!0,setTimeout(function(){y=!1},300)}function s(){"horizontal"===x.direction?w>=c?v.removeClass("forward").addClass("backward"):c>w&&v.removeClass("backward").addClass("forward"):w>=c?v.removeClass("forward").addClass("backward"):c>w&&v.removeClass("backward").addClass("forward")}function d(){if("horizontal"===x.direction){if(w>=c&&0===u||c>=w&&u===g-1)return!0}else if(w>=c&&0===u||c>=w&&u===g-1)return!0;return!1}function l(){C.css({"-webkit-animation":"none"}),a(".current [data-animation]").each(function(r,t){var i=a(t),n=i.attr("data-animation"),e=i.attr("data-duration")||500,o=i.attr("data-timing-function")||"ease",s=i.attr("data-delay")?i.attr("data-delay"):0,d=i.attr("data-iteration-count")||1;"followSlide"===n&&("horizontal"===x.direction&&"forward"===h?n="followSlideToLeft":"horizontal"===x.direction&&"backward"===h?n="followSlideToRight":"vertical"===x.direction&&"forward"===h?n="followSlideToTop":"vertical"===x.direction&&"backward"===h&&(n="followSlideToBottom"));var l=n+" "+e+"ms "+o+" "+s+"ms "+d+" both";i.css({"-webkit-animation":l,animation:l})})}var c,w,f,p,h,u,g,m,b,v,k,C,x,z=!1,y=!0;a.fn.parallax=function(t){return x=a.extend({},a.fn.parallax.defaults,t),this.each(function(){v=a(this),k=v.find(".page"),r()})},a.fn.parallax.defaults={direction:"vertical",swipeAnim:"default",drag:!0,loading:!1,indicator:!1,arrow:!1,onchange:function(){},orientationchange:function(){}},a(document).on("touchstart",".page",function(a){t(a.changedTouches[0])}).on("touchmove",".page",function(a){i(a.changedTouches[0])}).on("touchend",".page",function(a){n(a.changedTouches[0])}).on("webkitAnimationEnd webkitTransitionEnd",".pages",function(){"stay"!==h&&(setTimeout(function(){a(".back").hide().removeClass("back"),a(".front").show().removeClass("front"),v.removeClass("forward backward animate")},10),a(k.removeClass("current").get(u)).addClass("current"),x.onchange(u,k[u],h),l())}),a(".page *").on("webkitAnimationEnd",function(){event.stopPropagation()}),a(window).on("load",function(){if(x.loading&&(a(".parallax-loading").remove(),y=!1,a(k[u]).addClass("current"),x.onchange(u,k[u],h),l()),x.indicator){y=!1;var r="horizontal"===x.direction?"parallax-h-indicator":"parallax-v-indicator";a(".wrapper").append("<div class="+r+"></div>");for(var t="<ul>",i=1;g>=i;i++)t+=1===i?'<li class="current">'+i+"</li>":"<li>"+i+"</li>";t+="</ul>",a("."+r).append(t)}x.arrow&&(k.append('<span class="parallax-arrow"></span>'),a(k[g-1]).find(".parallax-arrow").remove())}),window.addEventListener("onorientationchange"in window?"orientationchange":"resize",function(){(180===window.orientation||0===window.orientation)&&x.orientationchange("portrait"),(90===window.orientation||-90===window.orientation)&&x.orientationchange("landscape")},!1)}(Zepto);